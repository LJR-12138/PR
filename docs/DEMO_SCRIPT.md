# 海狗面部识别项目演示脚本（7-8分钟）

## 0:00–0:30 开场介绍

大家好，今天我将为大家演示一个海狗面部识别与行为分析项目。这个项目旨在解决海洋生物学研究中的一个实际问题：如何自动识别和追踪野生海狗个体，分析它们的行为模式。

整个流程分为三个主要模块：
1. 面部检测 - 在照片中定位每只海狗的脸
2. 个体识别 - 区分不同的海狗个体
3. 行为分析 - 理解它们的社交和活动模式

## 0:30–1:00 数据统计与环境准备

首先，让我们了解一下数据情况和项目结构。

在数据方面，我们的训练数据集包含108张原始图片，经过数据增强后得到324张训练图片。这些图片都经过了人工标注，标出了海狗面部的位置。

项目结构采用模块化设计：
```
configs/               # 配置文件
scripts/               # 命令行脚本入口
src/                   # 核心源代码
data/                  # 数据集
outputs/               # 输出结果
```

演示数据来自 `data/furseal/task_datasets` 目录，用于推理与行为分析展示。

## 1:00–1:30 核心技术与配置

我们的处理流程包括：检测 → 裁脸 → 特征提取 → 聚类 → 行为图谱构建。

在模型选择方面，我们将YOLOv8n更换为YOLOv8s模型。主要原因如下：
1. **精度提升**：YOLOv8s相比YOLOv8n具有更多的参数和更深的网络结构，在海狗面部检测任务上能提供更高的精度
2. **性能平衡**：虽然YOLOv8s比YOLOv8n稍大，但在实际应用中仍能保持良好的推理速度，实现了精度与效率的良好平衡
3. **小目标检测**：YOLOv8s对小目标的检测能力更强，这对于远距离拍摄的海狗面部检测尤为重要

关键配置项包括：
- `inference.img_size: 1024` 和 `inference.augment_tta: true` - 使用更高分辨率和轻量级测试时增强来提升大脸召回率
- `inference.post_nms_duplicate_iou: 0.85` - 推理后使用IoU去重来抑制同一张脸的多个检测框
- `clustering.algorithm: dbscan`，`metric: cosine`，`eps: 0.15` - 使用DBSCAN聚类算法和余弦距离度量

## 1:30–2:30 面部检测演示

现在让我们实际运行检测过程：

```powershell
.\.venv\Scripts\python.exe -m scripts.run_detection --split valid
```

运行完成后，检测结果保存在 `outputs/detections/latest/` 目录中：
- `images/`：包含带边界框的可视化检测结果
- `labels/`：YOLO格式的文本标签文件

通过IoU去重处理，我们可以显著减少重复检测框。

## 2:30–3:00 面部特征提取

检测完成后，我们需要进行裁脸和特征提取：

```powershell
.\.venv\Scripts\python.exe -m scripts.build_embeddings
```

在这个阶段：
- 裁脸过程会过滤掉过小或低质量的检测框
- 提取面部特征用于后续聚类
- 默认使用颜色直方图特征（3×32 bins，L2归一化），在小样本域上表现更稳定

裁剪的人脸图像保存在 `outputs/faces/` 目录中。

## 3:00–3:30 个体聚类

接下来进行个体聚类：

```powershell
.\.venv\Scripts\python.exe -m scripts.cluster_identities
```

这个命令使用DBSCAN聚类算法，根据面部特征的相似性将它们分组。每个组代表一只独特的海狗。

让我们查看聚类结果：
```powershell
.\.venv\Scripts\python.exe -m scripts.view_identities
```

从可视化结果可以看到：
- 我们识别出了3个不同的海狗个体（身份0、1、2）
- 海狗1号是最活跃的个体，在24张照片中出现过
- 海狗0号和2号只在2张照片中出现
- 未分类的样本很少，说明聚类效果很好

## 3:30–4:30 行为分析

最后进行行为分析：

```powershell
.\.venv\Scripts\python.exe -m scripts.analyze_behaviour
```

这个步骤生成三个重要文件：
- `outputs/reports/summary.html` - 综合报告
- `outputs/reports/population_summary.csv` - 种群统计摘要
- `outputs/reports/cooccurrence.graphml` - 共现关系图

## 4:30–5:30 结果解读

通过这个完整的流程，我们可以得到以下重要信息：

1. **种群规模**: 在我们的数据集中，系统识别出了3只不同的海狗个体
2. **个体行为**: 海狗1号是最活跃的个体，可能是一只成年海狗，经常出现在不同的照片中
3. **社交关系**: 发现海狗0号和1号有共现关系，这可能表明它们之间存在某种社交联系

这些信息对海洋生物学家非常有价值，可以帮助他们：
- 估算海狗种群数量
- 研究海狗的社交行为
- 追踪个体海狗的活动规律

## 5:30–6:30 优势与局限

项目的优势：
- 通过1024分辨率+TTA+IoU去重，显著提升了大脸召回率并抑制了重复框
- 颜色直方图+DBSCAN在小样本情况下得到了3个有效簇和少量噪声点，足以支撑行为分析
- 整个流程完整打通，从训练到推理、裁脸、特征提取、聚类到行为报告

局限性：
- 小样本和域偏移导致特征分布不稳定
- 部分图片可能缺失EXIF（时间/GPS），这会影响行为分析的时空关联

## 6:30–7:30 总结与展望

这个项目展示了如何利用计算机视觉和机器学习技术来解决实际的生物学研究问题。通过自动化处理，研究人员可以节省大量时间，将精力集中在更高级的分析工作上。

未来可能的改进方向包括：
- 引入人脸关键点对齐以提高特征稳定性
- 使用轻量级ResNet/CLIP+PCA作为通用视觉特征
- 采用度量学习或半监督标签传播方法，扩大数据规模和时序覆盖

## 7:30–8:00 演示总结

通过这个完整的演示，我们展示了如何从原始海狗照片开始，经过检测、识别，最终得到行为分析报告的全过程。这个系统为海洋生物学家提供了一个强大的自动化工具，可以大大减少人工标注的工作量，提高研究效率。

感谢大家的观看！

---

**演示提示**：
1. 实际演示时，每个命令执行后都要稍作停顿，解释其作用和输出结果
2. 重点展示可视化结果，因为图表比文字更容易理解
3. 强调项目的实际应用价值，而不仅仅是技术细节
4. 控制好时间，确保在7-8分钟内完成整个演示